{
  "hash": "0541ebc48f89970bc26201c8584849f5",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: 'Chapter 1.1: Limitations of Standard Regression Analyses'\nformat: html\n---\n\n\n\n\nIn this chapter, we motivate the need for modern causal inference tools by walking through real-world examples where traditional regression fails. We also introduce the counterfactual (potential outcomes) framework as the foundation for defining causal effects.\n\n## Why Not Just Use Regression?\n\nMultivariable regression has long been the standard tool in observational research for \"adjusting\" for confounders. But regression coefficients don’t always represent causal effects.\n\nLet’s consider a motivating example based on a real-world study comparing two osteoporosis treatments: **denosumab** (Prolia) and **zoledronic acid**.\n\n### Motivating Example: Comparing Osteoporosis Treatments\n\nImagine we’re interested in whether patients who initiate denosumab have higher 3-year risk of heart attack or stroke compared to those initiating zoledronic acid.\n\nWe might be tempted to run the following:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# simulate crude comparison (not real data)\nset.seed(123)\nn <- 2000\ntreatment <- rbinom(n, 1, 0.5) # 1 = denosumab, 0 = zoledronic acid\nage <- rnorm(n, 75, 6)\ncvd_history <- rbinom(n, 1, plogis(0.1 * (age - 70)))\n\n# outcome depends on age and history\nrisk <- plogis(-2 + 0.4 * treatment + 0.05 * (age - 70) + 1 * cvd_history)\noutcome <- rbinom(n, 1, risk)\n\nmodel1 <- glm(outcome ~ treatment, family = binomial)\nsummary(model1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = outcome ~ treatment, family = binomial)\n\nCoefficients:\n            Estimate Std. Error z value Pr(>|z|)    \n(Intercept) -1.05939    0.07197 -14.720  < 2e-16 ***\ntreatment    0.33425    0.09887   3.381 0.000723 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 2414.0  on 1999  degrees of freedom\nResidual deviance: 2402.5  on 1998  degrees of freedom\nAIC: 2406.5\n\nNumber of Fisher Scoring iterations: 4\n```\n\n\n:::\n:::\n\n\n\n\nThis gives us a crude estimate of association, which is confounded by differences in age and comorbidities.\n\n### Adjusting for Confounders\n\nWe add adjustment:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel2 <- glm(outcome ~ treatment + age + cvd_history, family = binomial)\nsummary(model2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = outcome ~ treatment + age + cvd_history, family = binomial)\n\nCoefficients:\n             Estimate Std. Error z value Pr(>|z|)    \n(Intercept) -6.398207   0.694981  -9.206  < 2e-16 ***\ntreatment    0.366412   0.103506   3.540    4e-04 ***\nage          0.060479   0.009213   6.564 5.22e-11 ***\ncvd_history  1.090838   0.121918   8.947  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 2414.0  on 1999  degrees of freedom\nResidual deviance: 2223.1  on 1996  degrees of freedom\nAIC: 2231.1\n\nNumber of Fisher Scoring iterations: 4\n```\n\n\n:::\n:::\n\n\n\n\nBut is this **causal**? Not necessarily. We’re making strong parametric assumptions (e.g., log-linear effect of age), and regression *implicitly* defines the estimand. The treatment coefficient reflects a log-odds ratio comparing denosumab vs ZA, conditional on covariates. But this is *not* the average treatment effect in the population.\n\n## Enter the Counterfactual Framework\n\nTo define a causal effect, we introduce counterfactual outcomes:\n\n> **Y(1):** outcome if a person received denosumab  \n> **Y(0):** outcome if a person received zoledronic acid\n\nThe **average treatment effect (ATE)** is:\n\n$$\nE[Y(1) - Y(0)]\n$$\n\nBut in reality, each person only receives one treatment. The counterfactual under the other treatment is missing.\n\nUnder assumptions (exchangeability, consistency, positivity), we can identify the causal effect from observed data. For example, we can estimate:\n\n$$\nE_W[ E[Y | A = 1, W] - E[Y | A = 0, W] ]\n$$\n\nThis motivates **standardization**, **IPTW**, and **targeted learning**.\n\n## When Regression Fails\n\nEven if we include the right confounders, misspecification of functional form (e.g., assuming linearity, ignoring interactions) can bias results.\n\nLet’s compare regression to a nonparametric substitution estimator (g-computation):\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fit model\nmodel3 <- glm(outcome ~ treatment + age + cvd_history, family = binomial)\n\n# Predict counterfactual outcomes\nnewdata1 <- data.frame(treatment = 1, age = age, cvd_history = cvd_history)\np1 <- predict(model3, newdata = newdata1, type = \"response\")\n\nnewdata0 <- data.frame(treatment = 0, age = age, cvd_history = cvd_history)\np0 <- predict(model3, newdata = newdata0, type = \"response\")\n\n# Estimate marginal risk difference\nmean(p1 - p0)  # this is g-computation\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.06897059\n```\n\n\n:::\n:::\n\n\n\n\nCompare this to the regression coefficient:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoef(model3)[\"treatment\"]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntreatment \n0.3664119 \n```\n\n\n:::\n:::\n\n\n\n\nThe coefficient gives you a conditional odds ratio, but the g-comp version gives you a marginal risk difference — a more interpretable, population-level quantity.\n\n## Summary\n\n- Regression is not inherently causal — it estimates conditional associations under model assumptions.\n- Causal inference starts by defining a causal question and target estimand.\n- The counterfactual framework clarifies what we want to estimate.\n- G-computation, IPTW, and TMLE allow estimating causal effects without relying on regression coefficients.\n\n## Next\n\nIn the next chapter, we’ll introduce the Causal Roadmap — a structured workflow for planning and executing causal analyses.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}