{"title":"Chapter 1.1: Limitations of Standard Regression Analyses","markdown":{"yaml":{"title":"Chapter 1.1: Limitations of Standard Regression Analyses","format":"html"},"headingText":"Why Not Just Use Regression?","containsRefs":false,"markdown":"\n\nIn this chapter, we motivate the need for modern causal inference tools by walking through real-world examples where traditional regression fails. We also introduce the counterfactual (potential outcomes) framework as the foundation for defining causal effects.\n\n\nMultivariable regression has long been the standard tool in observational research for \"adjusting\" for confounders. But regression coefficients don’t always represent causal effects.\n\nLet’s consider a motivating example based on a real-world study comparing two osteoporosis treatments: **denosumab** (Prolia) and **zoledronic acid**.\n\n### Motivating Example: Comparing Osteoporosis Treatments\n\nImagine we’re interested in whether patients who initiate denosumab have higher 3-year risk of heart attack or stroke compared to those initiating zoledronic acid.\n\nWe might be tempted to run the following:\n\n```{r}\n# simulate crude comparison (not real data)\nset.seed(123)\nn <- 2000\ntreatment <- rbinom(n, 1, 0.5) # 1 = denosumab, 0 = zoledronic acid\nage <- rnorm(n, 75, 6)\ncvd_history <- rbinom(n, 1, plogis(0.1 * (age - 70)))\n\n# outcome depends on age and history\nrisk <- plogis(-2 + 0.4 * treatment + 0.05 * (age - 70) + 1 * cvd_history)\noutcome <- rbinom(n, 1, risk)\n\nmodel1 <- glm(outcome ~ treatment, family = binomial)\nsummary(model1)\n```\n\nThis gives us a crude estimate of association, which is confounded by differences in age and comorbidities.\n\n### Adjusting for Confounders\n\nWe add adjustment:\n\n```{r}\nmodel2 <- glm(outcome ~ treatment + age + cvd_history, family = binomial)\nsummary(model2)\n```\n\nBut is this **causal**? Not necessarily. We’re making strong parametric assumptions (e.g., log-linear effect of age), and regression *implicitly* defines the estimand. The treatment coefficient reflects a log-odds ratio comparing denosumab vs ZA, conditional on covariates. But this is *not* the average treatment effect in the population.\n\n## Enter the Counterfactual Framework\n\nTo define a causal effect, we introduce counterfactual outcomes:\n\n> **Y(1):** outcome if a person received denosumab  \n> **Y(0):** outcome if a person received zoledronic acid\n\nThe **average treatment effect (ATE)** is:\n\n$$\nE[Y(1) - Y(0)]\n$$\n\nBut in reality, each person only receives one treatment. The counterfactual under the other treatment is missing.\n\nUnder assumptions (exchangeability, consistency, positivity), we can identify the causal effect from observed data. For example, we can estimate:\n\n$$\nE_W[ E[Y | A = 1, W] - E[Y | A = 0, W] ]\n$$\n\nThis motivates **standardization**, **IPTW**, and **targeted learning**.\n\n## When Regression Fails\n\nEven if we include the right confounders, misspecification of functional form (e.g., assuming linearity, ignoring interactions) can bias results.\n\nLet’s compare regression to a nonparametric substitution estimator (g-computation):\n\n```{r}\n# Fit model\nmodel3 <- glm(outcome ~ treatment + age + cvd_history, family = binomial)\n\n# Predict counterfactual outcomes\nnewdata1 <- data.frame(treatment = 1, age = age, cvd_history = cvd_history)\np1 <- predict(model3, newdata = newdata1, type = \"response\")\n\nnewdata0 <- data.frame(treatment = 0, age = age, cvd_history = cvd_history)\np0 <- predict(model3, newdata = newdata0, type = \"response\")\n\n# Estimate marginal risk difference\nmean(p1 - p0)  # this is g-computation\n```\n\nCompare this to the regression coefficient:\n\n```{r}\ncoef(model3)[\"treatment\"]\n```\n\nThe coefficient gives you a conditional odds ratio, but the g-comp version gives you a marginal risk difference — a more interpretable, population-level quantity.\n\n## Summary\n\n- Regression is not inherently causal — it estimates conditional associations under model assumptions.\n- Causal inference starts by defining a causal question and target estimand.\n- The counterfactual framework clarifies what we want to estimate.\n- G-computation, IPTW, and TMLE allow estimating causal effects without relying on regression coefficients.\n\n## Next\n\nIn the next chapter, we’ll introduce the Causal Roadmap — a structured workflow for planning and executing causal analyses.\n","srcMarkdownNoYaml":"\n\nIn this chapter, we motivate the need for modern causal inference tools by walking through real-world examples where traditional regression fails. We also introduce the counterfactual (potential outcomes) framework as the foundation for defining causal effects.\n\n## Why Not Just Use Regression?\n\nMultivariable regression has long been the standard tool in observational research for \"adjusting\" for confounders. But regression coefficients don’t always represent causal effects.\n\nLet’s consider a motivating example based on a real-world study comparing two osteoporosis treatments: **denosumab** (Prolia) and **zoledronic acid**.\n\n### Motivating Example: Comparing Osteoporosis Treatments\n\nImagine we’re interested in whether patients who initiate denosumab have higher 3-year risk of heart attack or stroke compared to those initiating zoledronic acid.\n\nWe might be tempted to run the following:\n\n```{r}\n# simulate crude comparison (not real data)\nset.seed(123)\nn <- 2000\ntreatment <- rbinom(n, 1, 0.5) # 1 = denosumab, 0 = zoledronic acid\nage <- rnorm(n, 75, 6)\ncvd_history <- rbinom(n, 1, plogis(0.1 * (age - 70)))\n\n# outcome depends on age and history\nrisk <- plogis(-2 + 0.4 * treatment + 0.05 * (age - 70) + 1 * cvd_history)\noutcome <- rbinom(n, 1, risk)\n\nmodel1 <- glm(outcome ~ treatment, family = binomial)\nsummary(model1)\n```\n\nThis gives us a crude estimate of association, which is confounded by differences in age and comorbidities.\n\n### Adjusting for Confounders\n\nWe add adjustment:\n\n```{r}\nmodel2 <- glm(outcome ~ treatment + age + cvd_history, family = binomial)\nsummary(model2)\n```\n\nBut is this **causal**? Not necessarily. We’re making strong parametric assumptions (e.g., log-linear effect of age), and regression *implicitly* defines the estimand. The treatment coefficient reflects a log-odds ratio comparing denosumab vs ZA, conditional on covariates. But this is *not* the average treatment effect in the population.\n\n## Enter the Counterfactual Framework\n\nTo define a causal effect, we introduce counterfactual outcomes:\n\n> **Y(1):** outcome if a person received denosumab  \n> **Y(0):** outcome if a person received zoledronic acid\n\nThe **average treatment effect (ATE)** is:\n\n$$\nE[Y(1) - Y(0)]\n$$\n\nBut in reality, each person only receives one treatment. The counterfactual under the other treatment is missing.\n\nUnder assumptions (exchangeability, consistency, positivity), we can identify the causal effect from observed data. For example, we can estimate:\n\n$$\nE_W[ E[Y | A = 1, W] - E[Y | A = 0, W] ]\n$$\n\nThis motivates **standardization**, **IPTW**, and **targeted learning**.\n\n## When Regression Fails\n\nEven if we include the right confounders, misspecification of functional form (e.g., assuming linearity, ignoring interactions) can bias results.\n\nLet’s compare regression to a nonparametric substitution estimator (g-computation):\n\n```{r}\n# Fit model\nmodel3 <- glm(outcome ~ treatment + age + cvd_history, family = binomial)\n\n# Predict counterfactual outcomes\nnewdata1 <- data.frame(treatment = 1, age = age, cvd_history = cvd_history)\np1 <- predict(model3, newdata = newdata1, type = \"response\")\n\nnewdata0 <- data.frame(treatment = 0, age = age, cvd_history = cvd_history)\np0 <- predict(model3, newdata = newdata0, type = \"response\")\n\n# Estimate marginal risk difference\nmean(p1 - p0)  # this is g-computation\n```\n\nCompare this to the regression coefficient:\n\n```{r}\ncoef(model3)[\"treatment\"]\n```\n\nThe coefficient gives you a conditional odds ratio, but the g-comp version gives you a marginal risk difference — a more interpretable, population-level quantity.\n\n## Summary\n\n- Regression is not inherently causal — it estimates conditional associations under model assumptions.\n- Causal inference starts by defining a causal question and target estimand.\n- The counterfactual framework clarifies what we want to estimate.\n- G-computation, IPTW, and TMLE allow estimating causal effects without relying on regression coefficients.\n\n## Next\n\nIn the next chapter, we’ll introduce the Causal Roadmap — a structured workflow for planning and executing causal analyses.\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"output-file":"01-01-regression-vs-causal.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.42","theme":"cosmo","smooth-scroll":true,"title":"Chapter 1.1: Limitations of Standard Regression Analyses","sidebar":{"style":"docked","search":true,"contents":[{"text":"Overview","href":"index.qmd"},{"section":"Advanced topics","contents":[{"text":"1.1 Regression vs Causal Inference","href":"01-01-regression-vs-causal.qmd"},{"text":"1.2 The Causal Roadmap in detail","href":"01-02-causal-roadmap.qmd"},{"text":"1.3 Identification and Estimands","href":"01-03-identification-estimands.qmd"},{"text":"2.1 G-computation","href":"02-01-gcomputation.qmd"},{"text":"2.2 Inverse Probability of Treatment Weighting (IPTW)","href":"02-02-iptw.qmd"},{"text":"2.3 Doubly Robust Estimation and Targeted Maximum Likelihood Estimation (TMLE)","href":"02-03-doubly-robust-tmle.qmd"},{"text":"2.4 Super Learner","href":"02-04-superlearner.qmd"},{"text":"3.3 Longitudinal Case Study","href":"03-03-longitudinal-case-study.qmd"},{"text":"3.4 Effect Modification","href":"03-04-effect-modification.qmd"},{"text":"3.5 Advanced Diagnostics","href":"03-05-advanced-diagnostics.qmd"},{"text":"3.6 RWD meets RCT: Hybrid Designs","href":"03-06-rwd-meets-rct-hybrid-designs.qmd"},{"text":"3.7 Longitudinal Time-Dependent Confounding","href":"03-07-longitudinal-td-confounding.qmd"},{"text":"3.8 TMLE in the Clean Room Design","href":"03-08-tmle-clean-room.qmd"},{"text":"Covariate Adjustment IN RCTs using TMLE","href":"chapter_covariate_adjustment_tmle.qmd"},{"text":"Common Pitfalls in Causal Inference","href":"common-pitfalls.qmd"}]}]}},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}