---
title: "3. TMLE Concepts and Implementation"
format:
  html:
    toc: true
    toc-depth: 3
---

# Why TMLE?

TMLE provides a robust, efficient estimator for causal effects combining outcome regression and propensity score modeling.

It is **doubly robust** and allows the use of machine learning while preserving valid inference.

```{r, include=FALSE}

knitr::opts_chunk$set(
message = FALSE,
warning = FALSE
)

# Simulated example of data setup
set.seed(123)
n <- 1000
W <- data.frame(age = rnorm(n, 70, 8), ckd = rbinom(n, 1, 0.2))
A <- rbinom(n, 1, plogis(-1 + 0.02*W$age + 0.6*W$ckd))
Y <- rbinom(n, 1, plogis(-2 + 0.8*A + 0.04*W$age + 0.3*W$ckd))
```

```{r, cache=T}
library(tmle)
library(SuperLearner)
set.seed(123)
fit <- tmle(Y, A, W, family = "binomial",
            Q.SL.library = c("SL.glm", "SL.glmnet", "SL.ranger"),
            g.SL.library = c("SL.glm", "SL.ranger"))
summary(fit)
```

![Placeholder: TMLE workflow illustration.](../images/tmle_steps_placeholder.png)
*Figure 3. TMLE step-by-step schematic.*
